@using Klimaci.DTO.ProjectDTOs
@model BrandUpdateDTO
@{
    ViewData["Title"] = "Marka Düzenle";
    Layout = "~/Areas/Admin/Views/Shared/_AdminLayout.cshtml";
}
<div class="container py-3">
    <h1>Marka Düzenle</h1>
    @await Html.PartialAsync("~/Areas/Admin/Views/Shared/_AdminAlerts.cshtml")
    <form asp-action="Edit" method="post" class="vstack gap-3">
        <input type="hidden" asp-for="Id" />
        <div class="row g-3">
            <div class="col-lg-8">
                <label class="form-label">Başlık</label>
                <input asp-for="Title" class="form-control" id="title" />
                <label class="form-label mt-2">Website</label>
                <input asp-for="Website" class="form-control" placeholder="https://..." />
                <div class="form-check mt-2">
                    <input class="form-check-input" asp-for="IsPublished" /><label class="form-check-label" for="IsPublished">Yayında</label>
                </div>
            </div>
            <div class="col-lg-4">
                <label class="form-label">Slug</label>
                <div class="input-group">
                    <input asp-for="Slug" class="form-control" id="slug" />
                    <button type="button" class="btn btn-outline-secondary" id="btnSlug">Kontrol</button>
                </div>
                <div class="form-text" id="slugHint"></div>

                <label class="form-label mt-2">SEO Title</label>
                <input asp-for="SeoTitle" class="form-control" />
                <label class="form-label mt-2">SEO Description</label>
                <textarea asp-for="SeoDescription" rows="2" class="form-control"></textarea>

                <label class="form-label mt-2">Sıra</label>
                <input asp-for="DisplayOrder" class="form-control" />
            </div>
        </div>

        <div class="mt-3 d-flex gap-2">
            <button class="btn btn-primary">Kaydet</button>
            <a asp-action="Index" class="btn btn-light">Geri</a>
        </div>
        @Html.AntiForgeryToken()
    </form>
</div>

@section Scripts {
    <script>
        async function slugCheck(){
          const title=document.getElementById('title').value||''; const slug=document.getElementById('slug').value||''; const id='@Model.Id';
          const res=await fetch('@Url.Action("SlugCheck")',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({title,slug,excludeId:id})});
          const d=await res.json(); const input=document.getElementById('slug'); const hint=document.getElementById('slugHint');
          input.value=d.finalSlug||d.FinalSlug; const ok=d.isUnique??d.IsUnique; hint.textContent= ok?'Uygun.':'Çakışma vardı, düzeltildi.'; hint.className= ok?'form-text text-success':'form-text text-warning';
        }
        document.getElementById('btnSlug').addEventListener('click', slugCheck);
    </script>
}
